"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.execute = exports.NAME = void 0;
const ea_bootstrap_1 = require("@chainlink/ea-bootstrap");
const ethers_1 = require("ethers");
const luxon_1 = require("luxon");
exports.NAME = 'player-stats';
const customParams = {
    date: true,
    playerID: true,
};
const execute = async (request, _, config) => {
    const validator = new ea_bootstrap_1.Validator(request, customParams);
    if (validator.error)
        throw validator.error;
    const jobRunID = validator.validated.id;
    const { date, playerID } = validator.validated.data;
    const url = `/nba/stats/json/PlayerGameStatsByPlayer/${date}/${playerID}`;
    const params = {
        key: config.nbaKey,
    };
    const options = { ...config.api, params, url };
    const response = await ea_bootstrap_1.Requester.request(options);
    const d = luxon_1.DateTime.fromISO(response.data.DateTime, { zone: 'GMT' });
    const epochSeconds = d.valueOf() / 1000;
    return ea_bootstrap_1.Requester.success(jobRunID, ea_bootstrap_1.Requester.withResult(response, packResponse(response.data, epochSeconds)), config.verbose);
};
exports.execute = execute;
const packResponse = (response, epochS) => {
    const dataTypes = [
        'uint16',
        'uint32',
        'bool',
        'bool',
        'uint32',
        'uint8',
        'uint8',
        'uint8',
        'uint8',
        'uint8',
        'uint8',
        'uint8',
        'uint8',
        'uint8',
        'uint8',
        'uint8',
        'uint8',
        'uint8',
        'uint8',
        'uint8',
        'uint8',
        'uint16',
    ];
    const dataValues = [
        response.Season,
        epochS,
        response.HomeOrAway === 'HOME',
        response.isGameOver,
        response.GlobalGameID,
        response.FieldGoalsMade,
        response.FieldGoalsAttempted,
        response.TwoPointersMade,
        response.TwoPointersAttempted,
        response.ThreePointersMade,
        response.ThreePointersAttempted,
        response.FreeThrowsMade,
        response.FreeThrowsAttempted,
        response.OffensiveRebounds,
        response.DefensiveRebounds,
        response.Rebounds,
        response.Assists,
        response.Steals,
        response.BlockedShots,
        response.DoubleDoubles,
        response.TripleDoubles,
        response.Points,
    ];
    const packedResult = ethers_1.utils.solidityPack(dataTypes, dataValues);
    return packedResult.startsWith('0x') ? packedResult.substring(2) : packedResult;
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGxheWVyLXN0YXRzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL3Nwb3J0L25iYS9lbmRwb2ludC9wbGF5ZXItc3RhdHMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsMERBQThEO0FBRzlELG1DQUE4QjtBQUM5QixpQ0FBZ0M7QUFFbkIsUUFBQSxJQUFJLEdBQUcsY0FBYyxDQUFBO0FBRWxDLE1BQU0sWUFBWSxHQUFHO0lBQ25CLElBQUksRUFBRSxJQUFJO0lBQ1YsUUFBUSxFQUFFLElBQUk7Q0FDZixDQUFBO0FBd0ZNLE1BQU0sT0FBTyxHQUE4QixLQUFLLEVBQUUsT0FBTyxFQUFFLENBQUMsRUFBRSxNQUFNLEVBQUUsRUFBRTtJQUM3RSxNQUFNLFNBQVMsR0FBRyxJQUFJLHdCQUFTLENBQUMsT0FBTyxFQUFFLFlBQVksQ0FBQyxDQUFBO0lBQ3RELElBQUksU0FBUyxDQUFDLEtBQUs7UUFBRSxNQUFNLFNBQVMsQ0FBQyxLQUFLLENBQUE7SUFFMUMsTUFBTSxRQUFRLEdBQUcsU0FBUyxDQUFDLFNBQVMsQ0FBQyxFQUFFLENBQUE7SUFDdkMsTUFBTSxFQUFFLElBQUksRUFBRSxRQUFRLEVBQUUsR0FBRyxTQUFTLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQTtJQUNuRCxNQUFNLEdBQUcsR0FBRywyQ0FBMkMsSUFBSSxJQUFJLFFBQVEsRUFBRSxDQUFBO0lBRXpFLE1BQU0sTUFBTSxHQUFHO1FBQ2IsR0FBRyxFQUFFLE1BQU0sQ0FBQyxNQUFNO0tBQ25CLENBQUE7SUFFRCxNQUFNLE9BQU8sR0FBRyxFQUFFLEdBQUcsTUFBTSxDQUFDLEdBQUcsRUFBRSxNQUFNLEVBQUUsR0FBRyxFQUFFLENBQUE7SUFFOUMsTUFBTSxRQUFRLEdBQUcsTUFBTSx3QkFBUyxDQUFDLE9BQU8sQ0FBaUIsT0FBTyxDQUFDLENBQUE7SUFDakUsTUFBTSxDQUFDLEdBQUcsZ0JBQVEsQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUUsRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLENBQUMsQ0FBQTtJQUNuRSxNQUFNLFlBQVksR0FBRyxDQUFDLENBQUMsT0FBTyxFQUFFLEdBQUcsSUFBSSxDQUFBO0lBQ3ZDLE9BQU8sd0JBQVMsQ0FBQyxPQUFPLENBQ3RCLFFBQVEsRUFDUix3QkFBUyxDQUFDLFVBQVUsQ0FBQyxRQUFRLEVBQUUsWUFBWSxDQUFDLFFBQVEsQ0FBQyxJQUFJLEVBQUUsWUFBWSxDQUFDLENBQUMsRUFDekUsTUFBTSxDQUFDLE9BQU8sQ0FDZixDQUFBO0FBQ0gsQ0FBQyxDQUFBO0FBdEJZLFFBQUEsT0FBTyxXQXNCbkI7QUFFRCxNQUFNLFlBQVksR0FBRyxDQUFDLFFBQXdCLEVBQUUsTUFBYyxFQUFVLEVBQUU7SUFDeEUsTUFBTSxTQUFTLEdBQUc7UUFDaEIsUUFBUTtRQUNSLFFBQVE7UUFDUixNQUFNO1FBQ04sTUFBTTtRQUNOLFFBQVE7UUFDUixPQUFPO1FBQ1AsT0FBTztRQUNQLE9BQU87UUFDUCxPQUFPO1FBQ1AsT0FBTztRQUNQLE9BQU87UUFDUCxPQUFPO1FBQ1AsT0FBTztRQUNQLE9BQU87UUFDUCxPQUFPO1FBQ1AsT0FBTztRQUNQLE9BQU87UUFDUCxPQUFPO1FBQ1AsT0FBTztRQUNQLE9BQU87UUFDUCxPQUFPO1FBQ1AsUUFBUTtLQUNULENBQUE7SUFDRCxNQUFNLFVBQVUsR0FBRztRQUNqQixRQUFRLENBQUMsTUFBTTtRQUNmLE1BQU07UUFDTixRQUFRLENBQUMsVUFBVSxLQUFLLE1BQU07UUFDOUIsUUFBUSxDQUFDLFVBQVU7UUFDbkIsUUFBUSxDQUFDLFlBQVk7UUFDckIsUUFBUSxDQUFDLGNBQWM7UUFDdkIsUUFBUSxDQUFDLG1CQUFtQjtRQUM1QixRQUFRLENBQUMsZUFBZTtRQUN4QixRQUFRLENBQUMsb0JBQW9CO1FBQzdCLFFBQVEsQ0FBQyxpQkFBaUI7UUFDMUIsUUFBUSxDQUFDLHNCQUFzQjtRQUMvQixRQUFRLENBQUMsY0FBYztRQUN2QixRQUFRLENBQUMsbUJBQW1CO1FBQzVCLFFBQVEsQ0FBQyxpQkFBaUI7UUFDMUIsUUFBUSxDQUFDLGlCQUFpQjtRQUMxQixRQUFRLENBQUMsUUFBUTtRQUNqQixRQUFRLENBQUMsT0FBTztRQUNoQixRQUFRLENBQUMsTUFBTTtRQUNmLFFBQVEsQ0FBQyxZQUFZO1FBQ3JCLFFBQVEsQ0FBQyxhQUFhO1FBQ3RCLFFBQVEsQ0FBQyxhQUFhO1FBQ3RCLFFBQVEsQ0FBQyxNQUFNO0tBQ2hCLENBQUE7SUFDRCxNQUFNLFlBQVksR0FBRyxjQUFLLENBQUMsWUFBWSxDQUFDLFNBQVMsRUFBRSxVQUFVLENBQUMsQ0FBQTtJQUM5RCxPQUFPLFlBQVksQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLFlBQVksQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLFlBQVksQ0FBQTtBQUNqRixDQUFDLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBSZXF1ZXN0ZXIsIFZhbGlkYXRvciB9IGZyb20gJ0BjaGFpbmxpbmsvZWEtYm9vdHN0cmFwJ1xuaW1wb3J0IHsgRXhlY3V0ZVdpdGhDb25maWcgfSBmcm9tICdAY2hhaW5saW5rL3R5cGVzJ1xuaW1wb3J0IHsgQ29uZmlnIH0gZnJvbSAnLi4vLi4vLi4vY29uZmlnJ1xuaW1wb3J0IHsgdXRpbHMgfSBmcm9tICdldGhlcnMnXG5pbXBvcnQgeyBEYXRlVGltZSB9IGZyb20gJ2x1eG9uJ1xuXG5leHBvcnQgY29uc3QgTkFNRSA9ICdwbGF5ZXItc3RhdHMnXG5cbmNvbnN0IGN1c3RvbVBhcmFtcyA9IHtcbiAgZGF0ZTogdHJ1ZSxcbiAgcGxheWVySUQ6IHRydWUsXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUmVzcG9uc2VTY2hlbWEge1xuICBlcG9jaFM6IG51bWJlclxuICBTdGF0SUQ6IG51bWJlclxuICBUZWFtSUQ6IG51bWJlclxuICBQbGF5ZXJJRDogbnVtYmVyXG4gIFNlYXNvblR5cGU6IG51bWJlclxuICBTZWFzb246IG51bWJlclxuICBOYW1lOiBzdHJpbmdcbiAgVGVhbTogc3RyaW5nXG4gIFBvc2l0aW9uOiBzdHJpbmdcbiAgU3RhcnRlZDogbnVtYmVyXG4gIEZhbkR1ZWxTYWxhcnk6IG51bWJlclxuICBEcmFmdEtpbmdTYWxhcnk6IG51bWJlclxuICBGYW50YXN5RHVlbFNhbGFyeTogbnVtYmVyXG4gIFlhaG9vU2FsYXJ5OiBudW1iZXIgfCBudWxsXG4gIEluanVyeVN0YXR1czogc3RyaW5nIHwgbnVsbFxuICBJbmp1cnlCb2R5UGFydDogc3RyaW5nIHwgbnVsbFxuICBJbmp1cnlTdGFydERhdGU6IHN0cmluZyB8IG51bGxcbiAgSW5qdXJ5Tm90ZXM6IHN0cmluZyB8IG51bGxcbiAgRmFuRHVlbFBvc2l0aW9uOiBzdHJpbmdcbiAgRHJhZnRLaW5nUG9zaXRpb246IHN0cmluZ1xuICBZYWhvb1Bvc2l0aW9uOiBzdHJpbmcgfCBudWxsXG4gIE9wcG9uZW50UmFuazogbnVtYmVyXG4gIE9wcG9uZW50UG9zaXRpb25SYW5rOiBudW1iZXJcbiAgR2xvYmFsVGVhbUlEOiBudW1iZXJcbiAgRmFudGFzeURyYWZ0U2FsYXJ5OiBudW1iZXIgfCBudWxsXG4gIEZhbnRhc3lEcmFmdFBvc2l0aW9uOiBzdHJpbmcgfCBudWxsXG4gIEdhbWVJRDogbnVtYmVyXG4gIE9wcG9uZW50SUQ6IG51bWJlclxuICBPcHBvbmVudDogc3RyaW5nXG4gIERheTogc3RyaW5nXG4gIERhdGVUaW1lOiBzdHJpbmdcbiAgSG9tZU9yQXdheTogc3RyaW5nXG4gIGlzR2FtZU92ZXI6IHRydWVcbiAgR2xvYmFsR2FtZUlEOiBudW1iZXJcbiAgR2xvYmFsT3Bwb25lbnRJRDogbnVtYmVyXG4gIFVwZGF0ZWQ6IHN0cmluZ1xuICBHYW1lczogbnVtYmVyXG4gIEZhbnRhc3lQb2ludHM6IG51bWJlclxuICBNaW51dGVzOiBudW1iZXJcbiAgU2Vjb25kczogbnVtYmVyXG4gIEZpZWxkR29hbHNNYWRlOiBudW1iZXJcbiAgRmllbGRHb2Fsc0F0dGVtcHRlZDogbnVtYmVyXG4gIEZpZWxkR29hbHNQZXJjZW50YWdlOiBudW1iZXJcbiAgRWZmZWN0aXZlRmllbGRHb2Fsc1BlcmNlbnRhZ2U6IG51bWJlclxuICBUd29Qb2ludGVyc01hZGU6IG51bWJlclxuICBUd29Qb2ludGVyc0F0dGVtcHRlZDogbnVtYmVyXG4gIFR3b1BvaW50ZXJzUGVyY2VudGFnZTogbnVtYmVyXG4gIFRocmVlUG9pbnRlcnNNYWRlOiBudW1iZXJcbiAgVGhyZWVQb2ludGVyc0F0dGVtcHRlZDogbnVtYmVyXG4gIFRocmVlUG9pbnRlcnNQZXJjZW50YWdlOiBudW1iZXJcbiAgRnJlZVRocm93c01hZGU6IG51bWJlclxuICBGcmVlVGhyb3dzQXR0ZW1wdGVkOiBudW1iZXJcbiAgRnJlZVRocm93UGVyY2VudGFnZTogbnVtYmVyXG4gIE9mZmVuc2l2ZVJlYm91bmRzOiBudW1iZXJcbiAgRGVmZW5zaXZlUmVib3VuZHM6IG51bWJlclxuICBSZWJvdW5kczogbnVtYmVyXG4gIE9mZmVuc2l2ZVJlYm91bmRzUGVyY2VudGFnZTogbnVtYmVyXG4gIERlZmVuc2l2ZVJlYm91bmRzUGVyY2VuYWdlOiBudW1iZXJcbiAgVG90YWxSZWJvdW5kc1BlcmNlbnRhZ2U6IG51bWJlclxuICBBc3Npc3RzOiBudW1iZXJcbiAgU3RlYWxzOiBudW1iZXJcbiAgQmxvY2tlZFNob3RzOiBudW1iZXJcbiAgVHVybm92ZXJzOiBudW1iZXJcbiAgUGVyc29uYWxGb3VsczogbnVtYmVyXG4gIFBvaW50czogbnVtYmVyXG4gIFRydWVTaG9vdGluZ0F0dGVtcHRzOiBudW1iZXJcbiAgVHJ1ZVNob290aW5nUGVyY2VudGFnZTogbnVtYmVyXG4gIFBsYXllckVmZmljaWVuY3lSYXRpbmc6IG51bWJlclxuICBBc3Npc3RzUGVyY2VudGFnZTogbnVtYmVyXG4gIFN0ZWFsc1BlcmNlbnRhZ2U6IG51bWJlclxuICBCbG9ja3NQZXJjZW50YWdlOiBudW1iZXJcbiAgVHVybk92ZXJzUGVyY2VudGFnZTogbnVtYmVyXG4gIFVzYWdlUmF0ZVBlcmNlbnRhZ2U6IG51bWJlclxuICBGYW50YXN5UG9pbnRzRmFuRHVlbDogbnVtYmVyXG4gIEZhbnRhc3lQb2ludHNEcmFmdEtpbmdzOiBudW1iZXJcbiAgRmFudGFzeVBvaW50c1lhaG9vOiBudW1iZXJcbiAgUGx1c01pbnVzOiBudW1iZXJcbiAgRG91YmxlRG91YmxlczogbnVtYmVyXG4gIFRyaXBsZURvdWJsZXM6IG51bWJlclxuICBGYW50YXN5UG9pbnRzRmFudGFzeURyYWZ0OiBudW1iZXJcbiAgaXNDbG9zZWQ6IGJvb2xlYW5cbiAgTGluZXVwQ29uZmlybWVkOiBib29sZWFuXG4gIExpbmV1cFN0YXR1czogc3RyaW5nXG59XG5cbmV4cG9ydCBjb25zdCBleGVjdXRlOiBFeGVjdXRlV2l0aENvbmZpZzxDb25maWc+ID0gYXN5bmMgKHJlcXVlc3QsIF8sIGNvbmZpZykgPT4ge1xuICBjb25zdCB2YWxpZGF0b3IgPSBuZXcgVmFsaWRhdG9yKHJlcXVlc3QsIGN1c3RvbVBhcmFtcylcbiAgaWYgKHZhbGlkYXRvci5lcnJvcikgdGhyb3cgdmFsaWRhdG9yLmVycm9yXG5cbiAgY29uc3Qgam9iUnVuSUQgPSB2YWxpZGF0b3IudmFsaWRhdGVkLmlkXG4gIGNvbnN0IHsgZGF0ZSwgcGxheWVySUQgfSA9IHZhbGlkYXRvci52YWxpZGF0ZWQuZGF0YVxuICBjb25zdCB1cmwgPSBgL25iYS9zdGF0cy9qc29uL1BsYXllckdhbWVTdGF0c0J5UGxheWVyLyR7ZGF0ZX0vJHtwbGF5ZXJJRH1gXG5cbiAgY29uc3QgcGFyYW1zID0ge1xuICAgIGtleTogY29uZmlnLm5iYUtleSxcbiAgfVxuXG4gIGNvbnN0IG9wdGlvbnMgPSB7IC4uLmNvbmZpZy5hcGksIHBhcmFtcywgdXJsIH1cblxuICBjb25zdCByZXNwb25zZSA9IGF3YWl0IFJlcXVlc3Rlci5yZXF1ZXN0PFJlc3BvbnNlU2NoZW1hPihvcHRpb25zKVxuICBjb25zdCBkID0gRGF0ZVRpbWUuZnJvbUlTTyhyZXNwb25zZS5kYXRhLkRhdGVUaW1lLCB7IHpvbmU6ICdHTVQnIH0pXG4gIGNvbnN0IGVwb2NoU2Vjb25kcyA9IGQudmFsdWVPZigpIC8gMTAwMFxuICByZXR1cm4gUmVxdWVzdGVyLnN1Y2Nlc3MoXG4gICAgam9iUnVuSUQsXG4gICAgUmVxdWVzdGVyLndpdGhSZXN1bHQocmVzcG9uc2UsIHBhY2tSZXNwb25zZShyZXNwb25zZS5kYXRhLCBlcG9jaFNlY29uZHMpKSxcbiAgICBjb25maWcudmVyYm9zZSxcbiAgKVxufVxuXG5jb25zdCBwYWNrUmVzcG9uc2UgPSAocmVzcG9uc2U6IFJlc3BvbnNlU2NoZW1hLCBlcG9jaFM6IG51bWJlcik6IHN0cmluZyA9PiB7XG4gIGNvbnN0IGRhdGFUeXBlcyA9IFtcbiAgICAndWludDE2JyxcbiAgICAndWludDMyJyxcbiAgICAnYm9vbCcsXG4gICAgJ2Jvb2wnLFxuICAgICd1aW50MzInLFxuICAgICd1aW50OCcsXG4gICAgJ3VpbnQ4JyxcbiAgICAndWludDgnLFxuICAgICd1aW50OCcsXG4gICAgJ3VpbnQ4JyxcbiAgICAndWludDgnLFxuICAgICd1aW50OCcsXG4gICAgJ3VpbnQ4JyxcbiAgICAndWludDgnLFxuICAgICd1aW50OCcsXG4gICAgJ3VpbnQ4JyxcbiAgICAndWludDgnLFxuICAgICd1aW50OCcsXG4gICAgJ3VpbnQ4JyxcbiAgICAndWludDgnLFxuICAgICd1aW50OCcsXG4gICAgJ3VpbnQxNicsXG4gIF1cbiAgY29uc3QgZGF0YVZhbHVlcyA9IFtcbiAgICByZXNwb25zZS5TZWFzb24sXG4gICAgZXBvY2hTLFxuICAgIHJlc3BvbnNlLkhvbWVPckF3YXkgPT09ICdIT01FJyxcbiAgICByZXNwb25zZS5pc0dhbWVPdmVyLFxuICAgIHJlc3BvbnNlLkdsb2JhbEdhbWVJRCxcbiAgICByZXNwb25zZS5GaWVsZEdvYWxzTWFkZSxcbiAgICByZXNwb25zZS5GaWVsZEdvYWxzQXR0ZW1wdGVkLFxuICAgIHJlc3BvbnNlLlR3b1BvaW50ZXJzTWFkZSxcbiAgICByZXNwb25zZS5Ud29Qb2ludGVyc0F0dGVtcHRlZCxcbiAgICByZXNwb25zZS5UaHJlZVBvaW50ZXJzTWFkZSxcbiAgICByZXNwb25zZS5UaHJlZVBvaW50ZXJzQXR0ZW1wdGVkLFxuICAgIHJlc3BvbnNlLkZyZWVUaHJvd3NNYWRlLFxuICAgIHJlc3BvbnNlLkZyZWVUaHJvd3NBdHRlbXB0ZWQsXG4gICAgcmVzcG9uc2UuT2ZmZW5zaXZlUmVib3VuZHMsXG4gICAgcmVzcG9uc2UuRGVmZW5zaXZlUmVib3VuZHMsXG4gICAgcmVzcG9uc2UuUmVib3VuZHMsXG4gICAgcmVzcG9uc2UuQXNzaXN0cyxcbiAgICByZXNwb25zZS5TdGVhbHMsXG4gICAgcmVzcG9uc2UuQmxvY2tlZFNob3RzLFxuICAgIHJlc3BvbnNlLkRvdWJsZURvdWJsZXMsXG4gICAgcmVzcG9uc2UuVHJpcGxlRG91YmxlcyxcbiAgICByZXNwb25zZS5Qb2ludHMsXG4gIF1cbiAgY29uc3QgcGFja2VkUmVzdWx0ID0gdXRpbHMuc29saWRpdHlQYWNrKGRhdGFUeXBlcywgZGF0YVZhbHVlcylcbiAgcmV0dXJuIHBhY2tlZFJlc3VsdC5zdGFydHNXaXRoKCcweCcpID8gcGFja2VkUmVzdWx0LnN1YnN0cmluZygyKSA6IHBhY2tlZFJlc3VsdFxufVxuIl19