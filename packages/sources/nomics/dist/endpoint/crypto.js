"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.execute = exports.inputParameters = exports.endpointResultPaths = exports.batchablePropertyPath = exports.supportedEndpoints = void 0;
const ea_bootstrap_1 = require("@chainlink/ea-bootstrap");
const config_1 = require("../config");
exports.supportedEndpoints = ['crypto', 'price', 'marketcap', 'volume'];
exports.batchablePropertyPath = [{ name: 'base' }];
exports.endpointResultPaths = {
    crypto: 'price',
    price: 'price',
    marketcap: 'market_cap',
    volume: ['1d', 'volume'],
};
const customError = (data) => data.length === 0;
exports.inputParameters = {
    base: ['base', 'from', 'coin', 'ids'],
    quote: ['quote', 'to', 'market', 'convert'],
    resultPath: false,
};
const convertId = {
    FNX: 'FNX2',
    AMP: 'AMP2',
    WING: 'WING2',
    FTT: 'FTXTOKEN',
    KNC: 'KNC3',
};
const handleBatchedRequest = (jobRunID, request, response, validator, resultPath) => {
    const payload = [];
    for (const i in response.data) {
        const entry = response.data[i];
        payload.push([
            {
                ...request,
                data: {
                    ...request.data,
                    base: validator
                        .overrideReverseLookup(config_1.NAME, 'overrides', entry.symbol)
                        .toUpperCase(),
                },
            },
            ea_bootstrap_1.Requester.validateResultNumber(response.data[i], [resultPath]),
        ]);
    }
    return ea_bootstrap_1.Requester.success(jobRunID, ea_bootstrap_1.Requester.withResult(response, undefined, payload), true, exports.batchablePropertyPath);
};
const execute = async (request, _, config) => {
    const validator = new ea_bootstrap_1.Validator(request, exports.inputParameters);
    if (validator.error)
        throw validator.error;
    const symbol = validator.overrideSymbol(config_1.NAME);
    const symbols = Array.isArray(symbol) ? symbol : [symbol];
    const convert = validator.validated.data.quote.toUpperCase();
    const jobRunID = validator.validated.id;
    const resultPath = validator.validated.data.resultPath;
    const url = `/currencies/ticker`;
    // Correct common tickers that are misidentified
    const ids = symbols
        .map((symbol) => convertId[symbol.toUpperCase()] || symbol.toUpperCase())
        .join(',');
    const params = {
        ids,
        convert,
        key: config.apiKey,
    };
    const reqConfig = {
        ...config.api,
        url,
        params,
    };
    const response = await ea_bootstrap_1.Requester.request(reqConfig, customError);
    if (Array.isArray(symbol))
        return handleBatchedRequest(jobRunID, request, response, validator, resultPath);
    const result = ea_bootstrap_1.Requester.validateResultNumber(response.data[0], resultPath);
    return ea_bootstrap_1.Requester.success(jobRunID, ea_bootstrap_1.Requester.withResult(response, result), config.verbose, exports.batchablePropertyPath);
};
exports.execute = execute;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3J5cHRvLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL2VuZHBvaW50L2NyeXB0by50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFBQSwwREFBOEQ7QUFROUQsc0NBQStDO0FBRWxDLFFBQUEsa0JBQWtCLEdBQUcsQ0FBQyxRQUFRLEVBQUUsT0FBTyxFQUFFLFdBQVcsRUFBRSxRQUFRLENBQUMsQ0FBQTtBQUMvRCxRQUFBLHFCQUFxQixHQUFHLENBQUMsRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLENBQUMsQ0FBQTtBQUUxQyxRQUFBLG1CQUFtQixHQUFHO0lBQ2pDLE1BQU0sRUFBRSxPQUFPO0lBQ2YsS0FBSyxFQUFFLE9BQU87SUFDZCxTQUFTLEVBQUUsWUFBWTtJQUN2QixNQUFNLEVBQUUsQ0FBQyxJQUFJLEVBQUUsUUFBUSxDQUFDO0NBQ3pCLENBQUE7QUF3RUQsTUFBTSxXQUFXLEdBQUcsQ0FBQyxJQUFzQixFQUFFLEVBQUUsQ0FBQyxJQUFJLENBQUMsTUFBTSxLQUFLLENBQUMsQ0FBQTtBQUVwRCxRQUFBLGVBQWUsR0FBb0I7SUFDOUMsSUFBSSxFQUFFLENBQUMsTUFBTSxFQUFFLE1BQU0sRUFBRSxNQUFNLEVBQUUsS0FBSyxDQUFDO0lBQ3JDLEtBQUssRUFBRSxDQUFDLE9BQU8sRUFBRSxJQUFJLEVBQUUsUUFBUSxFQUFFLFNBQVMsQ0FBQztJQUMzQyxVQUFVLEVBQUUsS0FBSztDQUNsQixDQUFBO0FBRUQsTUFBTSxTQUFTLEdBQTJCO0lBQ3hDLEdBQUcsRUFBRSxNQUFNO0lBQ1gsR0FBRyxFQUFFLE1BQU07SUFDWCxJQUFJLEVBQUUsT0FBTztJQUNiLEdBQUcsRUFBRSxVQUFVO0lBQ2YsR0FBRyxFQUFFLE1BQU07Q0FDWixDQUFBO0FBRUQsTUFBTSxvQkFBb0IsR0FBRyxDQUMzQixRQUFnQixFQUNoQixPQUF1QixFQUN2QixRQUF5QyxFQUN6QyxTQUFvQixFQUNwQixVQUFrQixFQUNsQixFQUFFO0lBQ0YsTUFB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QVMsQ0FBQyxVQUFVLENBQUMsUUFBUSxFQUFFLE1BQU0sQ0FBQyxFQUN0QyxNQUFNLENBQUMsT0FBTyxFQUNkLDZCQUFxQixDQUN0QixDQUFBO0FBQ0gsQ0FBQyxDQUFBO0FBdkNZLFFBQUEsT0FBTyxXQXVDbkIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBSZXF1ZXN0ZXIsIFZhbGlkYXRvciB9IGZyb20gJ0BjaGFpbmxpbmsvZWEtYm9vdHN0cmFwJ1xuaW1wb3J0IHtcbiAgRXhlY3V0ZVdpdGhDb25maWcsXG4gIENvbmZpZyxcbiAgQXhpb3NSZXNwb25zZSxcbiAgQWRhcHRlclJlcXVlc3QsXG4gIElucHV0UGFyYW1ldGVycyxcbn0gZnJvbSAnQGNoYWlubGluay90eXBlcydcbmltcG9ydCB7IE5BTUUgYXMgQWRhcHRlck5hbWUgfSBmcm9tICcuLi9jb25maWcnXG5cbmV4cG9ydCBjb25zdCBzdXBwb3J0ZWRFbmRwb2ludHMgPSBbJ2NyeXB0bycsICdwcmljZScsICdtYXJrZXRjYXAnLCAndm9sdW1lJ11cbmV4cG9ydCBjb25zdCBiYXRjaGFibGVQcm9wZXJ0eVBhdGggPSBbeyBuYW1lOiAnYmFzZScgfV1cblxuZXhwb3J0IGNvbnN0IGVuZHBvaW50UmVzdWx0UGF0aHMgPSB7XG4gIGNyeXB0bzogJ3ByaWNlJyxcbiAgcHJpY2U6ICdwcmljZScsXG4gIG1hcmtldGNhcDogJ21hcmtldF9jYXAnLFxuICB2b2x1bWU6IFsnMWQnLCAndm9sdW1lJ10sXG59XG5cbmludGVyZmFjZSBSZXNwb25zZVNjaGVtYSB7XG4gIGlkOiBzdHJpbmdcbiAgY3VycmVuY3k6IHN0cmluZ1xuICBzeW1ib2w6IHN0cmluZ1xuICBuYW1lOiBzdHJpbmdcbiAgbG9nb191cmw6IHN0cmluZ1xuICBzdGF0dXM6IHN0cmluZ1xuICBwcmljZTogc3RyaW5nXG4gIHByaWNlX2RhdGU6IHN0cmluZ1xuICBwcmljZV90aW1lc3RhbXA6IHN0cmluZ1xuICBjaXJjdWxhdGluZ19zdXBwbHk6IHN0cmluZ1xuICBtYXhfc3VwcGx5OiBzdHJpbmdcbiAgbWFya2V0X2NhcDogc3RyaW5nXG4gIG51bV9leGNoYW5nZXM6IHN0cmluZ1xuICBudW1fcGFpcnM6IHN0cmluZ1xuICBudW1fcGFpcnNfdW5tYXBwZWQ6IHN0cmluZ1xuICBmaXJzdF9jYW5kbGU6IHN0cmluZ1xuICBmaXJzdF90cmFkZTogc3RyaW5nXG4gIGZpcnN0X29yZGVyX2Jvb2s6IHN0cmluZ1xuICByYW5rOiBzdHJpbmdcbiAgcmFua19kZWx0YTogc3RyaW5nXG4gIGhpZ2g6IHN0cmluZ1xuICBoaWdoX3RpbWVzdGFtcDogc3RyaW5nXG4gICcxZCc6IHtcbiAgICB2b2x1bWU6IHN0cmluZ1xuICAgIHByaWNlX2NoYW5nZTogc3RyaW5nXG4gICAgcHJpY2VfY2hhbmdlX3BjdDogc3RyaW5nXG4gICAgdm9sdW1lX2NoYW5nZTogc3RyaW5nXG4gICAgdm9sdW1lX2NoYW5nZV9wY3Q6IHN0cmluZ1xuICAgIG1hcmtldF9jYXBfY2hhbmdlOiBzdHJpbmdcbiAgICBtYXJrZXRfY2FwX2NoYW5nZV9wY3Q6IHN0cmluZ1xuICB9XG4gICc3ZCc6IHtcbiAgICB2b2x1bWU6IHN0cmluZ1xuICAgIHByaWNlX2NoYW5nZTogc3RyaW5nXG4gICAgcHJpY2VfY2hhbmdlX3BjdDogc3RyaW5nXG4gICAgdm9sdW1lX2NoYW5nZTogc3RyaW5nXG4gICAgdm9sdW1lX2NoYW5nZV9wY3Q6IHN0cmluZ1xuICAgIG1hcmtldF9jYXBfY2hhbmdlOiBzdHJpbmdcbiAgICBtYXJrZXRfY2FwX2NoYW5nZV9wY3Q6IHN0cmluZ1xuICB9XG4gICczMGQnOiB7XG4gICAgdm9sdW1lOiBzdHJpbmdcbiAgICBwcmljZV9jaGFuZ2U6IHN0cmluZ1xuICAgIHByaWNlX2NoYW5nZV9wY3Q6IHN0cmluZ1xuICAgIHZvbHVtZV9jaGFuZ2U6IHN0cmluZ1xuICAgIHZvbHVtZV9jaGFuZ2VfcGN0OiBzdHJpbmdcbiAgICBtYXJrZXRfY2FwX2NoYW5nZTogc3RyaW5nXG4gICAgbWFya2V0X2NhcF9jaGFuZ2VfcGN0OiBzdHJpbmdcbiAgfVxuICAnMzY1ZCc6IHtcbiAgICB2b2x1bWU6IHN0cmluZ1xuICAgIHByaWNlX2NoYW5nZTogc3RyaW5nXG4gICAgcHJpY2VfY2hhbmdlX3BjdDogc3RyaW5nXG4gICAgdm9sdW1lX2NoYW5nZTogc3RyaW5nXG4gICAgdm9sdW1lX2NoYW5nZV9wY3Q6IHN0cmluZ1xuICAgIG1hcmtldF9jYXBfY2hhbmdlOiBzdHJpbmdcbiAgICBtYXJrZXRfY2FwX2NoYW5nZV9wY3Q6IHN0cmluZ1xuICB9XG4gIHl0ZDoge1xuICAgIHZvbHVtZTogc3RyaW5nXG4gICAgcHJpY2VfY2hhbmdlOiBzdHJpbmdcbiAgICBwcmljZV9jaGFuZ2VfcGN0OiBzdHJpbmdcbiAgICB2b2x1bWVfY2hhbmdlOiBzdHJpbmdcbiAgICB2b2x1bWVfY2hhbmdlX3BjdDogc3RyaW5nXG4gICAgbWFya2V0X2NhcF9jaGFuZ2U6IHN0cmluZ1xuICAgIG1hcmtldF9jYXBfY2hhbmdlX3BjdDogc3RyaW5nXG4gIH1cbn1cblxuY29uc3QgY3VzdG9tRXJyb3IgPSAoZGF0YTogUmVzcG9uc2VTY2hlbWFbXSkgPT4gZGF0YS5sZW5ndGggPT09IDBcblxuZXhwb3J0IGNvbnN0IGlucHV0UGFyYW1ldGVyczogSW5wdXRQYXJhbWV0ZXJzID0ge1xuICBiYXNlOiBbJ2Jhc2UnLCAnZnJvbScsICdjb2luJywgJ2lkcyddLFxuICBxdW90ZTogWydxdW90ZScsICd0bycsICdtYXJrZXQnLCAnY29udmVydCddLFxuICByZXN1bHRQYXRoOiBmYWxzZSxcbn1cblxuY29uc3QgY29udmVydElkOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuICBGTlg6ICdGTlgyJyxcbiAgQU1QOiAnQU1QMicsXG4gIFdJTkc6ICdXSU5HMicsXG4gIEZUVDogJ0ZUWFRPS0VOJyxcbiAgS05DOiAnS05DMycsXG59XG5cbmNvbnN0IGhhbmRsZUJhdGNoZWRSZXF1ZXN0ID0gKFxuICBqb2JSdW5JRDogc3RyaW5nLFxuICByZXF1ZXN0OiBBZGFwdGVyUmVxdWVzdCxcbiAgcmVzcG9uc2U6IEF4aW9zUmVzcG9uc2U8UmVzcG9uc2VTY2hlbWFbXT4sXG4gIHZhbGlkYXRvcjogVmFsaWRhdG9yLFxuICByZXN1bHRQYXRoOiBzdHJpbmcsXG4pID0+IHtcbiAgY29uc3QgcGF5bG9hZDogW0FkYXB0ZXJSZXF1ZXN0LCBudW1iZXJdW10gPSBbXVxuICBmb3IgKGNvbnN0IGkgaW4gcmVzcG9uc2UuZGF0YSkge1xuICAgIGNvbnN0IGVudHJ5ID0gcmVzcG9uc2UuZGF0YVtpXVxuICAgIHBheWxvYWQucHVzaChbXG4gICAgICB7XG4gICAgICAgIC4uLnJlcXVlc3QsXG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAuLi5yZXF1ZXN0LmRhdGEsXG4gICAgICAgICAgYmFzZTogdmFsaWRhdG9yXG4gICAgICAgICAgICAub3ZlcnJpZGVSZXZlcnNlTG9va3VwKEFkYXB0ZXJOYW1lLCAnb3ZlcnJpZGVzJywgZW50cnkuc3ltYm9sKVxuICAgICAgICAgICAgLnRvVXBwZXJDYXNlKCksXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgUmVxdWVzdGVyLnZhbGlkYXRlUmVzdWx0TnVtYmVyKHJlc3BvbnNlLmRhdGFbaV0sIFtyZXN1bHRQYXRoXSksXG4gICAgXSlcbiAgfVxuXG4gIHJldHVybiBSZXF1ZXN0ZXIuc3VjY2VzcyhcbiAgICBqb2JSdW5JRCxcbiAgICBSZXF1ZXN0ZXIud2l0aFJlc3VsdChyZXNwb25zZSwgdW5kZWZpbmVkLCBwYXlsb2FkKSxcbiAgICB0cnVlLFxuICAgIGJhdGNoYWJsZVByb3BlcnR5UGF0aCxcbiAgKVxufVxuXG5leHBvcnQgY29uc3QgZXhlY3V0ZTogRXhlY3V0ZVdpdGhDb25maWc8Q29uZmlnPiA9IGFzeW5jIChyZXF1ZXN0LCBfLCBjb25maWcpID0+IHtcbiAgY29uc3QgdmFsaWRhdG9yID0gbmV3IFZhbGlkYXRvcihyZXF1ZXN0LCBpbnB1dFBhcmFtZXRlcnMpXG4gIGlmICh2YWxpZGF0b3IuZXJyb3IpIHRocm93IHZhbGlkYXRvci5lcnJvclxuXG4gIGNvbnN0IHN5bWJvbCA9IHZhbGlkYXRvci5vdmVycmlkZVN5bWJvbChBZGFwdGVyTmFtZSlcbiAgY29uc3Qgc3ltYm9scyA9IEFycmF5LmlzQXJyYXkoc3ltYm9sKSA/IHN5bWJvbCA6IFtzeW1ib2xdXG4gIGNvbnN0IGNvbnZlcnQgPSB2YWxpZGF0b3IudmFsaWRhdGVkLmRhdGEucXVvdGUudG9VcHBlckNhc2UoKVxuICBjb25zdCBqb2JSdW5JRCA9IHZhbGlkYXRvci52YWxpZGF0ZWQuaWRcbiAgY29uc3QgcmVzdWx0UGF0aCA9IHZhbGlkYXRvci52YWxpZGF0ZWQuZGF0YS5yZXN1bHRQYXRoXG5cbiAgY29uc3QgdXJsID0gYC9jdXJyZW5jaWVzL3RpY2tlcmBcbiAgLy8gQ29ycmVjdCBjb21tb24gdGlja2VycyB0aGF0IGFyZSBtaXNpZGVudGlmaWVkXG4gIGNvbnN0IGlkcyA9IHN5bWJvbHNcbiAgICAubWFwKChzeW1ib2wpID0+IGNvbnZlcnRJZFtzeW1ib2wudG9VcHBlckNhc2UoKV0gfHwgc3ltYm9sLnRvVXBwZXJDYXNlKCkpXG4gICAgLmpvaW4oJywnKVxuXG4gIGNvbnN0IHBhcmFtcyA9IHtcbiAgICBpZHMsXG4gICAgY29udmVydCxcbiAgICBrZXk6IGNvbmZpZy5hcGlLZXksXG4gIH1cbiAgY29uc3QgcmVxQ29uZmlnID0ge1xuICAgIC4uLmNvbmZpZy5hcGksXG4gICAgdXJsLFxuICAgIHBhcmFtcyxcbiAgfVxuXG4gIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgUmVxdWVzdGVyLnJlcXVlc3Q8UmVzcG9uc2VTY2hlbWFbXT4ocmVxQ29uZmlnLCBjdXN0b21FcnJvcilcblxuICBpZiAoQXJyYXkuaXNBcnJheShzeW1ib2wpKVxuICAgIHJldHVybiBoYW5kbGVCYXRjaGVkUmVxdWVzdChqb2JSdW5JRCwgcmVxdWVzdCwgcmVzcG9uc2UsIHZhbGlkYXRvciwgcmVzdWx0UGF0aClcblxuICBjb25zdCByZXN1bHQgPSBSZXF1ZXN0ZXIudmFsaWRhdGVSZXN1bHROdW1iZXIocmVzcG9uc2UuZGF0YVswXSwgcmVzdWx0UGF0aClcbiAgcmV0dXJuIFJlcXVlc3Rlci5zdWNjZXNzKFxuICAgIGpvYlJ1bklELFxuICAgIFJlcXVlc3Rlci53aXRoUmVzdWx0KHJlc3BvbnNlLCByZXN1bHQpLFxuICAgIGNvbmZpZy52ZXJib3NlLFxuICAgIGJhdGNoYWJsZVByb3BlcnR5UGF0aCxcbiAgKVxufVxuIl19