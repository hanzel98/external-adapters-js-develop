"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.isMarketClosed = void 0;
const ea_bootstrap_1 = require("@chainlink/ea-bootstrap");
const market_closure_1 = require("market-closure");
const customParams = {
    schedule: false,
};
const isMarketClosed = async (input) => {
    const validator = new ea_bootstrap_1.Validator(input, customParams);
    if (validator.error)
        throw validator.error;
    const schedule = validator.validated.data.schedule || {};
    if (Object.keys(schedule).length === 0)
        return false; // Empty schedule, just pass
    // If there is no timezone, the schedule is mis-configured
    if (!schedule.timezone || schedule.timezone.length === 0)
        throw new Error('timezone missing in schedule');
    const marketSchedule = new market_closure_1.MarketClosure(schedule);
    return marketSchedule.tradingHalted();
};
exports.isMarketClosed = isMarketClosed;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2NoZWR1bGUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvY2hlY2tzL3NjaGVkdWxlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFBLDBEQUFtRDtBQUVuRCxtREFBd0Q7QUFFeEQsTUFBTSxZQUFZLEdBQUc7SUFDbkIsUUFBUSxFQUFFLEtBQUs7Q0FDaEIsQ0FBQTtBQUVNLE1BQU0sY0FBYyxHQUFHLEtBQUssRUFBRSxLQUFxQixFQUFvQixFQUFFO0lBQzlFLE1BQU0sU0FBUyxHQUFHLElBQUksd0JBQVMsQ0FBQyxLQUFLLEVBQUUsWUFBWSxDQUFDLENBQUE7SUFDcEQsSUFBSSxTQUFTLENBQUMsS0FBSztRQUFFLE1BQU0sU0FBUyxDQUFDLEtBQUssQ0FBQTtJQUMxQyxNQUFNLFFBQVEsR0FBRyxTQUFTLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxRQUFRLElBQUksRUFBRSxDQUFBO0lBQ3hELElBQUksTUFBTSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxNQUFNLEtBQUssQ0FBQztRQUFFLE9BQU8sS0FBSyxDQUFBLENBQUMsNEJBQTRCO0lBRWpGLDBEQUEwRDtJQUMxRCxJQUFJLENBQUMsUUFBUSxDQUFDLFFBQVEsSUFBSSxRQUFRLENBQUMsUUFBUSxDQUFDLE1BQU0sS0FBSyxDQUFDO1FBQ3RELE1BQU0sSUFBSSxLQUFLLENBQUMsOEJBQThCLENBQUMsQ0FBQTtJQUVqRCxNQUFNLGNBQWMsR0FBRyxJQUFJLDhCQUFhLENBQUMsUUFBb0IsQ0FBQyxDQUFBO0lBQzlELE9BQU8sY0FBYyxDQUFDLGFBQWEsRUFBRSxDQUFBO0FBQ3ZDLENBQUMsQ0FBQTtBQVpZLFFBQUEsY0FBYyxrQkFZMUIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBWYWxpZGF0b3IgfSBmcm9tICdAY2hhaW5saW5rL2VhLWJvb3RzdHJhcCdcbmltcG9ydCB7IEFkYXB0ZXJSZXF1ZXN0IH0gZnJvbSAnQGNoYWlubGluay90eXBlcydcbmltcG9ydCB7IE1hcmtldENsb3N1cmUsIFNjaGVkdWxlIH0gZnJvbSAnbWFya2V0LWNsb3N1cmUnXG5cbmNvbnN0IGN1c3RvbVBhcmFtcyA9IHtcbiAgc2NoZWR1bGU6IGZhbHNlLFxufVxuXG5leHBvcnQgY29uc3QgaXNNYXJrZXRDbG9zZWQgPSBhc3luYyAoaW5wdXQ6IEFkYXB0ZXJSZXF1ZXN0KTogUHJvbWlzZTxib29sZWFuPiA9PiB7XG4gIGNvbnN0IHZhbGlkYXRvciA9IG5ldyBWYWxpZGF0b3IoaW5wdXQsIGN1c3RvbVBhcmFtcylcbiAgaWYgKHZhbGlkYXRvci5lcnJvcikgdGhyb3cgdmFsaWRhdG9yLmVycm9yXG4gIGNvbnN0IHNjaGVkdWxlID0gdmFsaWRhdG9yLnZhbGlkYXRlZC5kYXRhLnNjaGVkdWxlIHx8IHt9XG4gIGlmIChPYmplY3Qua2V5cyhzY2hlZHVsZSkubGVuZ3RoID09PSAwKSByZXR1cm4gZmFsc2UgLy8gRW1wdHkgc2NoZWR1bGUsIGp1c3QgcGFzc1xuXG4gIC8vIElmIHRoZXJlIGlzIG5vIHRpbWV6b25lLCB0aGUgc2NoZWR1bGUgaXMgbWlzLWNvbmZpZ3VyZWRcbiAgaWYgKCFzY2hlZHVsZS50aW1lem9uZSB8fCBzY2hlZHVsZS50aW1lem9uZS5sZW5ndGggPT09IDApXG4gICAgdGhyb3cgbmV3IEVycm9yKCd0aW1lem9uZSBtaXNzaW5nIGluIHNjaGVkdWxlJylcblxuICBjb25zdCBtYXJrZXRTY2hlZHVsZSA9IG5ldyBNYXJrZXRDbG9zdXJlKHNjaGVkdWxlIGFzIFNjaGVkdWxlKVxuICByZXR1cm4gbWFya2V0U2NoZWR1bGUudHJhZGluZ0hhbHRlZCgpXG59XG4iXX0=